<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BossX - Crypto Exchange Platform</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000000;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      overflow-x: hidden;
    }

    /* Corner Dots */
    .corner-dot {
      position: absolute; width: 8px; height: 8px; border-radius: 50%;
      background: #f59e0b; opacity: 0; z-index: 10;
    }
    .corner-dot.top-left { top: 10px; left: 10px; }
    .corner-dot.top-right { top: 10px; right: 10px; }
    .corner-dot.bottom-right { bottom: 10px; right: 10px; }
    .corner-dot.bottom-left { bottom: 10px; left: 10px; }

    /* Border Lines with Animation */
    .border-line {
      position: absolute; opacity: 0; pointer-events: none;
    }
    .border-top { top: 0; left: 0; width: 100%; height: 2px; background: linear-gradient(90deg, transparent, #f59e0b, #ec4899, #f59e0b, transparent); animation: borderTop 3s linear infinite; transform-origin: left; }
    .border-right { top: 0; right: 0; width: 2px; height: 100%; background: linear-gradient(180deg, transparent, #f59e0b, #ec4899, #f59e0b, transparent); animation: borderRight 3s linear infinite 0.75s; transform-origin: top; }
    .border-bottom { bottom: 0; right: 0; width: 100%; height: 2px; background: linear-gradient(270deg, transparent, #f59e0b, #ec4899, #f59e0b, transparent); animation: borderBottom 3s linear infinite 1.5s; transform-origin: right; }
    .border-left { bottom: 0; left: 0; width: 2px; height: 100%; background: linear-gradient(0deg, transparent, #f59e0b, #ec4899, #f59e0b, transparent); animation: borderLeft 3s linear infinite 2.25s; transform-origin: bottom; }

    @keyframes borderTop { 0% { width: 0; } 50% { width: 100%; } 100% { width: 0; } }
    @keyframes borderRight { 0% { height: 0; } 50% { height: 100%; } 100% { height: 0; } }
    @keyframes borderBottom { 0% { width: 0; } 50% { width: 100%; } 100% { width: 0; } }
    @keyframes borderLeft { 0% { height: 0; } 50% { height: 100%; } 100% { height: 0; } }

    .stat-card:hover .corner-dot,
    .stat-card:hover .border-line {
      opacity: 1;
    }

    /* Hover Scale */
    .hover-scale {
      transition: transform 0.3s ease;
    }
    .hover-scale:hover {
      transform: translateY(-5px);
    }

    /* Power Button */
    .power-button {
      position: relative; width: 60px; height: 60px; border-radius: 50%;
      border: 3px solid #374151; cursor: pointer; display: flex;
      align-items: center; justify-content: center; transition: all 0.3s ease;
    }
    .power-button.on {
      background: linear-gradient(145deg, #059669, #047857);
      border-color: #10b981;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
    }
    .power-button.off {
      background: linear-gradient(145deg, #b91c1c, #991b1b);
      border-color: #ef4444;
      box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
    }
    .power-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    .power-button:hover:not(:disabled) {
      transform: translateY(-2px);
    }

    .power-icon {
      color: white;
      width: 24px;
      height: 24px;
    }

    /* Countdown Timer */
    .countdown-timer {
      font-family: 'Courier New', monospace;
      font-weight: bold;
      color: #10b981;
      text-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
    }

    .auto-claim-timer {
      font-size: 0.9rem;
      color: #f59e0b;
    }

    /* Glowing Border */
    .glowing-border::before {
      content: '';
      position: absolute;
      inset: -2px;
      background: linear-gradient(45deg, #f59e0b, #ec4899, #8b5cf6, #06b6d4);
      z-index: -1;
      border-radius: 1rem;
      animation: gradientShift 3s ease infinite;
    }

    @keyframes gradientShift {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    /* Running Text */
    #running-text {
      animation: scroll-left 60s linear infinite;
    }
    @keyframes scroll-left {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    #running-text:hover {
      animation-play-state: paused;
    }

    /* Toast Messages */
    .success-message, .error-message {
      position: fixed; top: 20px; right: 20px; padding: 1rem 1.5rem;
      border-radius: 0.5rem; z-index: 1000; animation: slideIn 0.3s ease-out;
    }
    .success-message {
      background: linear-gradient(145deg, #10b981, #059669);
      color: white;
    }
    .error-message {
      background: linear-gradient(145deg, #dc2626, #b91c1c);
      color: white;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Tabs */
    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 8px;
      background: #f59e0b;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    /* Network Selection */
    .network-option.selected {
      border: 2px solid #f59e0b;
      padding: 10px;
      border-radius: 0.5rem;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 640px) {
      .stats-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body class="bg-black">

<div class="flex h-screen">

  <!-- Sidebar -->
  <aside id="sidebar" class="w-64 bg-gray-900 border-r border-gray-800 p-6 flex flex-col">
    <div class="logo mb-8">
      <h1 class="text-2xl font-bold text-amber-500">BossX</h1>
    </div>
    <nav class="space-y-2 flex-1">
      <a href="#" class="menu-item active flex items-center px-2 py-2 mb-2 rounded-xl text-white" data-page="dashboard">
        <i data-lucide="home" class="w-4 h-4"></i>
        <span class="ml-2 font-medium menu-text text-sm">Dashboard</span>
      </a>
      <a href="#" class="menu-item flex items-center px-2 py-2 mb-2 rounded-xl text-gray-400" data-page="deposit">
        <i data-lucide="plus-circle" class="w-4 h-4"></i>
        <span class="ml-2 font-medium menu-text text-sm">Deposit</span>
      </a>
      <a href="#" class="menu-item flex items-center px-2 py-2 mb-2 rounded-xl text-gray-400" data-page="withdrawal">
        <i data-lucide="minus-circle" class="w-4 h-4"></i>
        <span class="ml-2 font-medium menu-text text-sm">Withdrawal</span>
      </a>
      <a href="#" class="menu-item flex items-center px-2 py-2 mb-2 rounded-xl text-gray-400" data-page="chat-room">
        <i data-lucide="message-circle" class="w-4 h-4"></i>
        <span class="ml-2 font-medium menu-text text-sm">Chat Room</span>
      </a>
      <a href="#" class="menu-item flex items-center px-2 py-2 mb-2 rounded-xl text-gray-400" data-page="faq">
        <i data-lucide="help-circle" class="w-4 h-4"></i>
        <span class="ml-2 font-medium menu-text text-sm">FAQ</span>
      </a>
    </nav>
    <div class="profile mt-auto">
      <p class="text-sm text-gray-400">Logged in as</p>
      <p class="text-white font-semibold">User</p>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 overflow-auto">
    <div id="content" class="content-container space-y-4 p-6">

      <!-- Dashboard Page -->
      <div id="dashboard-page" class="page-content active">
        <div class="bg-gray-900 border border-amber-500/20 rounded-xl p-3 overflow-hidden mb-6">
          <div id="running-text" class="whitespace-nowrap text-amber-400 font-medium text-sm">
            Selamat datang di BossX! Reward mengalir per detik saat validasi aktif. Auto-stop jam 06:00 setiap hari.
          </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div class="stat-card p-6 bg-gray-900 border border-red-500/20 rounded-xl hover-scale relative">
            <div class="corner-dot top-left"></div><div class="corner-dot top-right"></div>
            <div class="corner-dot bottom-right"></div><div class="corner-dot bottom-left"></div>
            <div class="border-line border-top"></div><div class="border-line border-right"></div>
            <div class="border-line border-bottom"></div><div class="border-line border-left"></div>
            <p class="text-sm text-gray-400">Saldo USDT</p>
            <p class="text-2xl font-bold text-white mt-2" id="usdt-balance">500.00 USDT</p>
          </div>
          <div class="stat-card p-6 bg-gray-900 border border-green-500/20 rounded-xl hover-scale relative">
            <div class="corner-dot top-left"></div><div class="corner-dot top-right"></div>
            <div class="corner-dot bottom-right"></div><div class="corner-dot bottom-left"></div>
            <div class="border-line border-top"></div><div class="border-line border-right"></div>
            <div class="border-line border-bottom"></div><div class="border-line border-left"></div>
            <p class="text-sm text-gray-400">Saldo BOSSX</p>
            <p class="text-2xl font-bold text-white mt-2" id="bossx-balance">1000.000000000 BOSSX</p>
          </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          <div class="stat-card p-6 bg-gray-900 border border-blue-500/20 rounded-xl relative">
            <div class="corner-dot top-left"></div><div class="corner-dot top-right"></div>
            <div class="corner-dot bottom-right"></div><div class="corner-dot bottom-left"></div>
            <div class="border-line border-top"></div><div class="border-line border-right"></div>
            <div class="border-line border-bottom"></div><div class="border-line border-left"></div>
            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
              <i data-lucide="server" class="mr-2 text-blue-400 w-5 h-5"></i> Aktivasi Node
            </h3>
            <div class="mb-4">
              <label class="block text-sm text-gray-400 mb-2">Jumlah Stake (min 10 BOSSX)</label>
              <input type="number" id="stake-amount" class="node-input w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white" placeholder="Masukkan jumlah BOSSX" min="10" value="10">
            </div>
            <button id="activate-node-btn" class="w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-blue-700 transition">Aktivasi Node</button>
          </div>

          <div class="stat-card p-6 bg-gray-900 border border-green-500/20 rounded-xl relative">
            <div class="corner-dot top-left"></div><div class="corner-dot top-right"></div>
            <div class="corner-dot bottom-right"></div><div class="corner-dot bottom-left"></div>
            <div class="border-line border-top"></div><div class="border-line border-right"></div>
            <div class="border-line border-bottom"></div><div class="border-line border-left"></div>
            <h3 class="text-lg font-bold text-white mb-4 flex items-center">
              <i data-lucide="zap" class="mr-2 text-green-400 w-5 h-5"></i> Reward Validasi
            </h3>
            <p class="text-sm text-gray-400 mb-2">Status: <span id="validation-status" class="text-yellow-400">Belum berjalan</span></p>
            <p class="text-sm text-gray-400 mb-4" id="countdown-display" style="display:none;">
              Countdown: <span id="countdown-time" class="countdown-timer">00:00:00</span>
            </p>
            <p id="power-status" class="text-xs text-gray-500" style="display: none;">Masternode sedang running - Auto stop jam 06:00</p>
            <div class="flex items-center justify-center mt-6">
              <button id="power-btn" class="power-button off" onclick="togglePower()">
                <i data-lucide="power" id="power-icon" class="power-icon"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Deposit Page -->
      <div id="deposit-page" class="page-content hidden">
        <h2 class="text-2xl font-bold mb-6">Deposit</h2>
        <div class="bg-gray-900 p-6 rounded-xl mb-6 glowing-border relative">
          <div class="flex mb-4">
            <button id="usdt-tab" class="tab-button active relative px-8 py-3 rounded-xl font-semibold bg-gradient-to-r from-red-500 to-red-600 text-white mr-2">USDT</button>
            <button id="bossx-tab" class="tab-button relative px-8 py-3 rounded-xl font-semibold bg-gray-800 text-gray-400 hover:bg-gray-700">BOSSX</button>
          </div>
          <div class="mt-6 text-center">
            <p class="text-gray-300 mb-4">Kirim token ke alamat berikut:</p>
            <div class="bg-gray-800 p-4 rounded-lg font-mono text-lg mb-4 break-all" id="wallet-address">TQ3HBNdVFmTFvz9wz3AR2Siss7MRN1fuRM</div>
            <img id="qr-code-image" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TQ3HBNdVFmTFvz9wz3AR2Siss7MRN1fuRM" alt="QR Code" class="mx-auto mb-4">
            <button id="copy-address" class="bg-amber-500 hover:bg-amber-600 text-white px-6 py-3 rounded-lg mr-2">Salin Alamat</button>
            <button id="download-qr" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg">Download QR</button>
          </div>
        </div>
        <div class="bg-gray-900 p-6 rounded-xl">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">Riwayat Deposit</h3>
            <button id="refresh-history" class="text-amber-500 hover:text-amber-400">Refresh</button>
          </div>
          <div id="history-content" class="text-center py-12">
            <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="calendar" class="text-gray-400 w-6 h-6"></i></div>
            <h4 class="text-gray-400 text-lg font-semibold mb-2">Belum ada history deposit</h4>
            <p class="text-gray-500">History deposit USDT Anda akan muncul di sini</p>
          </div>
        </div>
      </div>

      <!-- Withdrawal Page -->
      <div id="withdrawal-page" class="page-content hidden">
        <h2 class="text-2xl font-bold mb-6">Withdrawal</h2>
        <div class="bg-gray-900 p-6 rounded-xl mb-6">
          <div class="flex mb-6">
            <button id="withdrawal-usdt-tab" class="tab-button active relative px-8 py-3 rounded-xl font-semibold bg-gradient-to-r from-red-500 to-red-600 text-white mr-2">USDT</button>
            <button id="withdrawal-bossx-tab" class="tab-button relative px-8 py-3 rounded-xl font-semibold bg-gray-800 text-gray-400 hover:bg-gray-700">BOSSX</button>
          </div>
          <p class="text-gray-300 mb-4">Saldo: <strong id="withdrawal-balance">500.00 USDT</strong></p>
          <div class="space-y-4">
            <input type="text" id="withdrawal-address" placeholder="Alamat Wallet Tujuan" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white">
            <div class="flex">
              <input type="number" id="withdrawal-amount" placeholder="Jumlah" class="flex-1 p-3 bg-gray-800 border border-gray-700 rounded-l-lg text-white">
              <button id="max-withdrawal" class="bg-gray-700 text-white px-4 rounded-r-lg">MAX</button>
            </div>
            <div id="network-selection" class="grid grid-cols-2 gap-3">
              <label class="network-option selected">
                <input type="radio" name="withdrawal-network" value="TRC20" checked> TRC20
                <div class="text-xs text-gray-500">Fee: 1 USDT</div>
              </label>
              <label class="network-option">
                <input type="radio" name="withdrawal-network" value="BEP20"> BEP20
                <div class="text-xs text-gray-500">Fee: 1 USDT</div>
              </label>
            </div>
            <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4">
              <ul class="text-sm text-gray-300 space-y-1">
                <li id="withdrawal-min">‚Ä¢ Minimal withdrawal: 10 USDT</li>
                <li id="withdrawal-fee">‚Ä¢ Fee withdrawal: 1 USDT</li>
                <li>‚Ä¢ Periksa kembali alamat tujuan sebelum konfirmasi</li>
                <li>‚Ä¢ Proses withdrawal membutuhkan waktu 1-24 jam</li>
              </ul>
            </div>
            <button id="withdrawal-submit" class="w-full py-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold rounded-lg hover:from-red-600 hover:to-red-700 transition">Submit Withdrawal</button>
          </div>
        </div>
        <div class="bg-gray-900 p-6 rounded-xl">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">Riwayat Withdrawal</h3>
            <button id="refresh-withdrawal-history" class="text-amber-500 hover:text-amber-400">Refresh</button>
          </div>
          <div id="withdrawal-history-content" class="text-center py-12">
            <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="calendar" class="text-gray-400 w-6 h-6"></i></div>
            <h4 class="text-gray-400 text-lg font-semibold mb-2">Belum ada history withdrawal</h4>
            <p class="text-gray-500">History withdrawal USDT Anda akan muncul di sini</p>
          </div>
        </div>
      </div>

      <!-- Chat Room Page -->
      <div id="chat-room-page" class="page-content hidden"></div>

      <!-- FAQ Page -->
      <div id="faq-page" class="page-content hidden">
        <h2 class="text-2xl font-bold mb-6">FAQ</h2>
        <div class="bg-gray-900 p-6 rounded-xl">
          <div class="space-y-4">
            <div class="border-b border-gray-700 pb-4">
              <h3 class="font-bold text-amber-400">Apa itu BossX?</h3>
              <p class="text-gray-300">Platform kripto untuk staking, masternode, dan trading.</p>
            </div>
            <div class="border-b border-gray-700 pb-4">
              <h3 class="font-bold text-amber-400">Bagaimana cara aktivasi node?</h3>
              <p class="text-gray-300">Stake minimal 10 BOSSX di dashboard.</p>
            </div>
            <div class="border-b border-gray-700 pb-4">
              <h3 class="font-bold text-amber-400">Kapan reward dihentikan otomatis?</h3>
              <p class="text-gray-300">Setiap pukul 06:00 WIB.</p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- JavaScript -->
<script type="text/babel">
  const { useState, useEffect, useRef } = React;

  function initializeChatRoom() {
    const root = document.getElementById('chat-room-page');
    const App = () => {
      const [currentRoom, setCurrentRoom] = useState('#validator');
      const [messages, setMessages] = useState([
        { id: 1, sender: 'BossX Bot', content: 'üëã Selamat datang di Chat Room BossX!', timestamp: '10:00', room: '#validator', isUser: false },
        { id: 2, sender: 'Admin', content: 'Ada yang punya pertanyaan tentang validator?', timestamp: '10:05', room: '#validator', isUser: false },
      ]);
      const [messageInput, setMessageInput] = useState('');
      const messagesEndRef = useRef(null);

      const handleSendMessage = () => {
        if (!messageInput.trim()) return;
        const newMessage = {
          id: Date.now(),
          sender: 'You',
          content: messageInput,
          timestamp: new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'}),
          room: currentRoom,
          isUser: true
        };
        setMessages(prev => [...prev, newMessage]);
        setMessageInput('');
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleSendMessage();
        }
      };

      useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      }, [messages]);

      const filteredMessages = messages.filter(m => m.room === currentRoom);

      return (
        <div className="min-h-screen bg-black text-white p-4">
          <div className="max-w-7xl mx-auto flex flex-col h-full">
            <div className="flex items-center justify-between mb-4">
              <button onClick={() => window.showPage('dashboard')} className="text-amber-500">‚Üê Kembali</button>
              <h1 className="text-2xl font-bold text-amber-500">Chat Room BossX</h1>
              <div className="bg-green-500/10 border border-green-500/30 text-green-400 px-4 py-2 rounded-full text-sm font-bold">8 Online</div>
            </div>
            <div className="flex h-[calc(100%-80px)] gap-4">
              <div className="w-64 bg-gray-950/80 border-r border-gray-700 p-4 rounded-lg">
                <h3 className="font-bold mb-4">Rooms</h3>
                {['#validator', '#trading', '#support', '#founder'].map(room => (
                  <button key={room} onClick={() => setCurrentRoom(room)} className={`w-full text-left p-2 rounded ${currentRoom === room ? 'bg-amber-500/20 text-amber-400' : 'text-gray-300 hover:bg-gray-800'}`}>
                    {room}
                  </button>
                ))}
                <div className="mt-6">
                  <h3 className="font-bold mb-4">Online Users</h3>
                  {['Admin', 'Founder', 'Moderator', 'Validator01', 'Trader Pro'].map(user => (
                    <div key={user} className="flex items-center gap-2 p-2 rounded hover:bg-gray-800">
                      <div className="w-6 h-6 bg-amber-500 rounded-full flex items-center justify-center text-xs font-bold">{user[0]}</div>
                      <span>{user}</span>
                    </div>
                  ))}
                </div>
              </div>
              <div className="flex-1 flex flex-col">
                <div className="flex-1 overflow-y-auto space-y-4 p-4 bg-gray-900/50 rounded-lg mb-4">
                  {filteredMessages.map(msg => (
                    <div key={msg.id} className={`flex ${msg.isUser ? 'justify-end' : 'justify-start'}`}>
                      <div className={`max-w-xs rounded-2xl p-3 ${msg.isUser ? 'bg-gradient-to-r from-amber-500 to-blue-500 text-white' : 'bg-gray-800 text-gray-100'}`}>
                        <div className="text-xs opacity-70">{msg.sender}</div>
                        <div>{msg.content}</div>
                        <div className="text-xs opacity-70 text-right mt-1">{msg.timestamp}</div>
                      </div>
                    </div>
                  ))}
                  <div ref={messagesEndRef} />
                </div>
                <div className="flex gap-2">
                  <textarea
                    value={messageInput}
                    onChange={(e) => setMessageInput(e.target.value)}
                    onKeyPress={handleKeyPress}
                    placeholder="Tulis pesan..."
                    maxLength={500}
                    className="flex-1 bg-gray-800 border border-gray-600 text-white placeholder:text-gray-400 rounded-2xl resize-none min-h-[60px] p-4 focus:border-amber-500 focus:bg-gray-700 focus:outline-none"
                  />
                  <button onClick={handleSendMessage} className="bg-gradient-to-r from-amber-500 to-blue-500 hover:from-amber-600 hover:to-blue-600 text-white font-bold px-8 py-4 rounded-2xl min-w-[140px] transition-all duration-300 flex items-center gap-2">Kirim</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };
    ReactDOM.render(<App />, root);
  }
</script>

<script>
  // ========== GLOBAL VARIABLES ==========
  let usdtBalance = 500;
  let bossxBalance = 1000;
  let stakedAmount = 0;
  let isNodeActive = false;
  let isValidationRunning = false;
  let currentValidationReward = 0;
  let totalRewardBalance = 0;
  let validationInterval = null;
  let autoClaimInterval = null;
  let countdownInterval = null;

  let activeTab = 'USDT';
  let activeWithdrawalTab = 'USDT';

  const walletAddresses = {
    USDT: { address: 'TQ3HBNdVFmTFvz9wz3AR2Siss7MRN1fuRM', qrCode: 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TQ3HBNdVFmTFvz9wz3AR2Siss7MRN1fuRM' },
    BOSSX: { address: 'TTfKjrU18mi223ukVmz6FMNgBkma13kVA3', qrCode: 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TTfKjrU18mi223ukVmz6FMNgBkma13kVA3' }
  };

  const withdrawalConfig = {
    USDT: { networks: { TRC20: { fee: 1, min: 10 }, BEP20: { fee: 1, min: 10 } } },
    BOSSX: { networks: { TRC20: { fee: 0.1, min: 1 } } }
  };

  const depositHistory = {
    USDT: [{ id: '1', amount: 500.00, txHash: 'a1b2c3...', status: 'confirmed', timestamp: new Date() }],
    BOSSX: []
  };

  const withdrawalHistory = {
    USDT: [],
    BOSSX: []
  };

  // ========== FUNCTIONS ==========
  function updateBalanceDisplays() {
    document.getElementById('usdt-balance').textContent = `${formatAmount(usdtBalance)} USDT`;
    document.getElementById('bossx-balance').textContent = `${formatAmount(bossxBalance, 9)} BOSSX`;
  }

  function formatAmount(num, max = 2) {
    return new Intl.NumberFormat('id-ID', { maximumFractionDigits: max }).format(num);
  }

  function showSuccessMessage(msg) {
    const existing = document.querySelector('.success-message');
    if (existing) existing.remove();
    const div = document.createElement('div');
    div.className = 'success-message';
    div.textContent = msg;
    document.body.appendChild(div);
    setTimeout(() => div.remove(), 3000);
  }

  function showErrorMessage(msg) {
    const existing = document.querySelector('.error-message');
    if (existing) existing.remove();
    const div = document.createElement('div');
    div.className = 'error-message';
    div.textContent = msg;
    document.body.appendChild(div);
    setTimeout(() => div.remove(), 3000);
  }

  function showPage(pageId) {
    document.querySelectorAll('.page-content').forEach(p => { p.classList.remove('active'); p.classList.add('hidden'); });
    document.getElementById(`${pageId}-page`).classList.remove('hidden'); document.getElementById(`${pageId}-page`).classList.add('active');
    document.querySelectorAll('.menu-item').forEach(item => { item.classList.remove('active'); item.classList.add('text-gray-400'); });
    document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
    if (pageId === 'chat-room') initializeChatRoom();
    else if (pageId === 'deposit') updateDepositContent();
    else if (pageId === 'withdrawal') updateWithdrawalContent();
  }

  // ========== DASHBOARD ==========
  document.getElementById('activate-node-btn').addEventListener('click', function() {
    const inputAmount = parseFloat(document.getElementById('stake-amount').value);
    if (!inputAmount || inputAmount < 10) return showErrorMessage('Minimal stake 10 BOSSX!');
    if (inputAmount > bossxBalance) return showErrorMessage('Saldo BOSSX tidak mencukupi!');
    stakedAmount = inputAmount;
    bossxBalance -= inputAmount;
    isNodeActive = true;
    updateBalanceDisplays();
    this.innerHTML = 'Node Aktif ‚úì';
    this.disabled = true;
    document.getElementById('stake-amount').disabled = true;
    document.getElementById('node-status')?.textContent = 'Aktif';
    showSuccessMessage(`Node aktif! Stake: ${inputAmount} BossX. Silakan tekan Power ON untuk mulai validasi.`);
  });

  function togglePower() {
    if (!isNodeActive) return showErrorMessage('Aktivasi node terlebih dahulu!');
    if (isValidationRunning) return showErrorMessage('Validasi sedang berjalan. Hanya bisa dihentikan oleh sistem.');
    const btn = document.getElementById('power-btn');
    isValidationRunning = true;
    btn.classList.replace('off', 'on');
    btn.disabled = true;
    document.getElementById('validation-status').textContent = 'Stop validasi setiap jam 06.00';
    document.getElementById('countdown-display').style.display = 'block';
    document.getElementById('power-status').style.display = 'block';
    startCountdown(); startValidationRunning(); startAutoClaimCountdown();
    showSuccessMessage('Validasi dimulai! Auto-claim aktif setiap 60 detik.');
  }

  function forceStopValidation() {
    if (!isValidationRunning) return;
    isValidationRunning = false;
    const btn = document.getElementById('power-btn');
    btn.classList.replace('on', 'off');
    btn.disabled = false;
    document.getElementById('validation-status').textContent = 'Belum berjalan';
    document.getElementById('countdown-display').style.display = 'none';
    document.getElementById('power-status').style.display = 'none';
    if (countdownInterval) clearInterval(countdownInterval);
    stopValidationRunning(); stopAutoClaimCountdown();
    showSuccessMessage('Validasi dihentikan otomatis pada jam 06:00. Silakan aktifkan kembali nanti.');
  }

  function startValidationRunning() {
    if (!isNodeActive) return;
    const rewardPerSecond = stakedAmount * 0.00000003858;
    validationInterval = setInterval(() => {
      if (!isValidationRunning) return;
      currentValidationReward += rewardPerSecond;
      document.getElementById('validation-status').innerHTML = `Reward sementara: <strong>${currentValidationReward.toFixed(9)} BossX</strong>`;
    }, 1000);
  }

  function stopValidationRunning() {
    if (validationInterval) clearInterval(validationInterval);
  }

  function startAutoClaimCountdown() {
    let autoClaimSeconds = 60;
    autoClaimInterval = setInterval(() => {
      if (--autoClaimSeconds <= 0) {
        performAutoClaim();
        autoClaimSeconds = 60;
      }
    }, 1000);
  }

  function performAutoClaim() {
    if (currentValidationReward <= 0) return;
    totalRewardBalance += currentValidationReward;
    currentValidationReward = 0;
    showSuccessMessage(`Auto Claim: +${totalRewardBalance.toFixed(9)} BossX`);
    updateBalanceDisplays();
    forceStopValidation();
  }

  function startCountdown() {
    countdownInterval = setInterval(updateCountdown, 1000);
  }

  function updateCountdown() {
    const now = new Date();
    const target = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 6, 0, 0);
    if (now >= target) target.setDate(target.getDate() + 1);
    const diff = target - now;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    document.getElementById('countdown-time').textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }

  function checkSixAMStop() {
    const now = new Date();
    if (now.getHours() === 6 && now.getMinutes() === 0 && isValidationRunning) {
      forceStopValidation();
    }
  }

  // ========== DEPOSIT ==========
  function updateDepositContent() {
    const wallet = walletAddresses[activeTab];
    document.getElementById('wallet-address').textContent = wallet.address;
    document.getElementById('qr-code-image').src = wallet.qrCode;
    document.getElementById('usdt-tab').classList.toggle('active', activeTab === 'USDT');
    document.getElementById('bossx-tab').classList.toggle('active', activeTab === 'BOSSX');
  }

  document.getElementById('copy-address').addEventListener('click', () => copyToClipboard(walletAddresses[activeTab].address));
  document.getElementById('download-qr').addEventListener('click', () => {
    const a = document.createElement('a');
    a.href = walletAddresses[activeTab].qrCode;
    a.download = `${activeTab}_qrcode.png`;
    a.click();
  });

  // ========== INIT ==========
  window.addEventListener('load', () => {
    lucide.createIcons();
    showPage('dashboard');
    setInterval(checkSixAMStop, 1000);
    updateBalanceDisplays();
    showSuccessMessage('Selamat datang di BossX!');
  });

  document.querySelectorAll('.menu-item').forEach(item => {
    item.addEventListener('click', e => { e.preventDefault(); showPage(item.getAttribute('data-page')); });
  });

  document.getElementById('usdt-tab')?.addEventListener('click', () => { activeTab = 'USDT'; updateDepositContent(); });
  document.getElementById('bossx-tab')?.addEventListener('click', () => { activeTab = 'BOSSX'; updateDepositContent(); });
</script>

</body>
</html>
